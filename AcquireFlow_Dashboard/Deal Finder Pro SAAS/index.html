<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REI Pro - Auto Offers</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light Mode Colors */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-purple: #8b5cf6;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border-color: #334155;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            -webkit-font-smoothing: antialiased;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            padding: 24px;
            overflow-y: auto;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 32px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-blue), #1d4ed8);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }

        .logo-text {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: -0.025em;
        }

        .nav-section {
            margin-bottom: 32px;
        }

        .nav-title {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 12px;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-secondary);
            position: relative;
        }

        .nav-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--accent-blue), #2563eb);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .nav-item .badge {
            background: var(--accent-orange);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
            animation: pulse 2s infinite;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
            background: var(--bg-primary);
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 20px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .page-title-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 800;
            letter-spacing: -0.025em;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .auto-status {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            font-weight: 600;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: var(--accent-blue);
            color: white;
            transform: translateY(-1px);
        }

        .btn.primary {
            background: linear-gradient(135deg, var(--accent-blue), #2563eb);
            color: white;
        }

        .btn.success {
            background: linear-gradient(135deg, var(--accent-green), #059669);
            color: white;
        }

        .btn.danger {
            background: linear-gradient(135deg, var(--accent-red), #dc2626);
            color: white;
        }

        /* Page Content */
        .page-content {
            padding: 32px;
        }

        /* Control Panel */
        .control-panel {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 24px;
            align-items: center;
        }

        .control-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .control-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-blue), #2563eb);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .control-text h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .control-text p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .automation-toggle {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 32px;
            background: var(--accent-green);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.off {
            background: var(--text-muted);
        }

        .toggle-knob {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            transform: translateX(28px);
        }

        .toggle-switch.off .toggle-knob {
            transform: translateX(0);
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 900;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            font-weight: 600;
        }

        /* Filters and Search */
        .filters-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .filter-input {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 14px;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .filter-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .select {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 14px;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* Offers Table */
        .offers-table-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
        }

        .table-header-section {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 20px;
            font-weight: 700;
        }

        .table-actions {
            display: flex;
            gap: 12px;
        }

        .offers-table {
            width: 100%;
        }

        .table-header {
            background: var(--bg-tertiary);
            padding: 16px 24px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 0.5px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr auto;
            gap: 16px;
        }

        .table-row {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr auto;
            gap: 16px;
            align-items: center;
            transition: all 0.3s ease;
        }

        .table-row:hover {
            background: var(--bg-tertiary);
        }

        .property-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .property-image {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-blue), #2563eb);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .property-details h4 {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .property-details p {
            font-size: 12px;
            color: var(--text-muted);
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            text-align: center;
        }

        .status-badge.sent {
            background: rgba(59, 130, 246, 0.1);
            color: var(--accent-blue);
        }

        .status-badge.accepted {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
        }

        .status-badge.rejected {
            background: rgba(239, 68, 68, 0.1);
            color: var(--accent-red);
        }

        .status-badge.pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--accent-orange);
        }

        .status-badge.negotiating {
            background: rgba(139, 92, 246, 0.1);
            color: var(--accent-purple);
        }

        .metric-cell {
            font-size: 14px;
            font-weight: 600;
        }

        .action-dropdown {
            position: relative;
            display: inline-block;
        }

        .action-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: var(--accent-blue);
            color: white;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            min-width: 150px;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-item {
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }

        .dropdown-item:hover {
            background: var(--bg-tertiary);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 24px;
        }

        .page-btn {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .page-btn:hover, .page-btn.active {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-primary);
            border-radius: 16px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .control-panel, .filters-section, .offers-table-section {
            animation: slideIn 0.6s ease-out;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .quick-stats {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 16px 20px;
                flex-direction: column;
                gap: 16px;
            }
            
            .page-content {
                padding: 20px;
            }
            
            .control-panel {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .table-row, .table-header {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }

        /* Loading and Animation Styles */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }

        .loading-spinner {
            position: relative;
            min-height: 50px;
        }

        /* Pagination Styles */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
        }

        .pagination-btn {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .pagination-btn.active {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Enhanced dropdown positioning */
        .dropdown-content {
            position: absolute;
            right: 0;
            top: 100%;
            z-index: 1000;
        }

        /* Toggle switch enhancements */
        .toggle-switch .slider {
            transition: transform 0.3s ease;
        }

        .toggle-switch.off .slider {
            transform: translateX(0) !important;
        }
    </style>
</head>
<body data-theme="light">
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <div class="logo-icon">🤖</div>
            <div class="logo-text">REI Pro</div>
        </div>

        <div class="nav-section">
            <div class="nav-title">Automation</div>
            <div class="nav-item">
                <div class="nav-icon">📊</div>
                <span>Dashboard</span>
            </div>
            <div class="nav-item active">
                <div class="nav-icon">🎯</div>
                <span>Auto Offers</span>
                <span class="badge">24</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">⚙️</div>
                <span>Criteria Setup</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">📋</div>
                <span>Offer Templates</span>
            </div>
        </div>

        <div class="nav-section">
            <div class="nav-title">Portfolio</div>
            <div class="nav-item">
                <div class="nav-icon">🏠</div>
                <span>Properties</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">📈</div>
                <span>Analytics</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">💰</div>
                <span>Finances</span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <div class="page-title-section">
                <h1 class="page-title">
                    🎯 Auto Offers
                </h1>
                <div class="auto-status">
                    <div class="status-dot"></div>
                    AI Active
                </div>
            </div>
            <div class="header-actions">
                <button class="btn" onclick="toggleTheme()">🌙 Theme</button>
                <button class="btn primary" onclick="showCreateOfferModal()">➕ Create Offer</button>
                <button class="btn success" onclick="showSettingsModal()">⚙️ Settings</button>
            </div>
        </div>

        <!-- Page Content -->
        <div class="page-content">
            <!-- Control Panel -->
            <div class="control-panel">
                <div class="control-info">
                    <div class="control-icon">🤖</div>
                    <div class="control-text">
                        <h3>Automation Engine</h3>
                        <p>Automatically scan and submit offers on qualifying properties</p>
                    </div>
                </div>
                <div class="automation-toggle">
                    <span style="font-weight: 600; margin-right: 12px;">Automation</span>
                    <div class="toggle-switch" onclick="toggleAutomation(this)">
                        <div class="toggle-knob"></div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="stat-card">
                    <div class="stat-value" style="color: var(--accent-blue);">247</div>
                    <div class="stat-label">Total Offers Sent</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: var(--accent-green);">24</div>
                    <div class="stat-label">Today's Offers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: var(--accent-orange);">18.5%</div>
                    <div class="stat-label">Acceptance Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: var(--accent-purple);">$2.3M</div>
                    <div class="stat-label">Pending Offers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: var(--accent-red);">89.2hrs</div>
                    <div class="stat-label">Time Saved</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: var(--accent-green);">$4.2M</div>
                    <div class="stat-label">Accepted Value</div>
                </div>
            </div>

            <!-- Filters Section -->
            <div class="filters-section">
                <div class="filters-header">
                    <h3>Filter Offers</h3>
                    <button class="btn" onclick="clearFilters()">Clear All</button>
                </div>
                <div class="filters-grid">
                    <div class="filter-group">
                        <label class="filter-label">Status</label>
                        <select class="select" id="statusFilter">
                            <option value="">All Statuses</option>
                            <option value="sent">Sent</option>
                            <option value="accepted">Accepted</option>
                            <option value="rejected">Rejected</option>
                            <option value="pending">Pending</option>
                            <option value="negotiating">Negotiating</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Property Type</label>
                        <select class="select" id="typeFilter">
                            <option value="">All Types</option>
                            <option value="single-family">Single Family</option>
                            <option value="multi-family">Multi Family</option>
                            <option value="commercial">Commercial</option>
                            <option value="land">Land</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Date Range</label>
                        <select class="select" id="dateFilter">
                            <option value="">All Time</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Location</label>
                        <input type="text" class="filter-input" placeholder="City, State" id="locationFilter">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">ROI Range</label>
                        <select class="select" id="roiFilter">
                            <option value="">All ROI</option>
                            <option value="0-10">0% - 10%</option>
                            <option value="10-15">10% - 15%</option>
                            <option value="15-20">15% - 20%</option>
                            <option value="20+">20%+</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">&nbsp;</label>
                        <button class="btn primary" onclick="applyFilters()">Apply Filters</button>
                    </div>
                </div>
            </div>

            <!-- Offers Table -->
            <div class="offers-table-section">
                <div class="table-header-section">
                    <h2 class="table-title">All Auto Offers</h2>
                    <div class="table-actions">
                        <button class="btn">📤 Export</button>
                        <button class="btn">📊 Analyze</button>
                        <button class="btn primary">➕ Bulk Actions</button>
                    </div>
                </div>
                
                <div class="offers-table">
                    <div class="table-header">
                        <div>Property</div>
                        <div>Offer Amount</div>
                        <div>Status</div>
                        <div>ROI</div>
                        <div>Response</div>
                        <div>Date Sent</div>
                        <div>Actions</div>
                    </div>
                    
                    <div class="table-row">
                        <div class="property-info">
                            <div class="property-image">🏠</div>
                            <div class="property-details">
                                <h4>123 Oak Street</h4>
                                <p>Chicago, IL • 3BR/2BA • 1,850 sqft</p>
                            </div>
                        </div>
                        <div class="metric-cell">$245,000</div>
                        <div><span class="status-badge accepted">Accepted</span></div>
                        <div class="metric-cell">22.3%</div>
                        <div class="metric-cell">2 days</div>
                        <div class="metric-cell">Jan 15, 2024</div>
                        <div class="action-dropdown">
                            <button class="action-btn" onclick="toggleDropdown(this)">⋯</button>
                            <div class="dropdown-content">
                                <div class="dropdown-item">View Details</div>
                                <div class="dropdown-item">Send Follow-up</div>
                                <div class="dropdown-item">Edit Offer</div>
                                <div class="dropdown-item">Withdraw</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-row">
                        <div class="property-info">
                            <div class="property-image">🏢</div>
                            <div class="property-details">
                                <h4>456 Pine Avenue</h4>
                                <p>Austin, TX • 4BR/3BA • 2,250 sqft</p>
                            </div>
                        </div>
                        <div class="metric-cell">$320,000</div>
                        <div><span class="status-badge pending">Pending</span></div>
                        <div class="metric-cell">18.7%</div>
                        <div class="metric-cell">5 days</div>
                        <div class="metric-cell">Jan 12, 2024</div>
                        <div class="action-dropdown">
                            <button class="action-btn" onclick="toggleDropdown(this)">⋯</button>
                            <div class="dropdown-content">
                                <div class="dropdown-item">View Details</div>
                                <div class="dropdown-item">Send Follow-up</div>
                                <div class="dropdown-item">Edit Offer</div>
                                <div class="dropdown-item">Withdraw</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-row">
                        <div class="property-info">
                            <div class="property-image">🏘️</div>
                            <div class="property-details">
                                <h4>789 Maple Drive</h4>
                                <p>Denver, CO • 2BR/1BA • 1,200 sqft</p>
                            </div>
                        </div>
                        <div class="metric-cell">$180,000</div>
                        <div><span class="status-badge negotiating">Negotiating</span></div>
                        <div class="metric-cell">25.1%</div>
                        <div class="metric-cell">1 day</div>
                        <div class="metric-cell">Jan 10, 2024</div>
                        <div class="action-dropdown">
                            <button class="action-btn" onclick="toggleDropdown(this)">⋯</button>
                            <div class="dropdown-content">
                                <div class="dropdown-item">View Details</div>
                                <div class="dropdown-item">Send Follow-up</div>
                                <div class="dropdown-item">Edit Offer</div>
                                <div class="dropdown-item">Withdraw</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-row">
                        <div class="property-info">
                            <div class="property-image">🏡</div>
                            <div class="property-details">
                                <h4>321 Elm Street</h4>
                                <p>Phoenix, AZ • 3BR/2BA • 1,600 sqft</p>
                            </div>
                        </div>
                        <div class="metric-cell">$215,000</div>
                        <div><span class="status-badge rejected">Rejected</span></div>
                        <div class="metric-cell">19.8%</div>
                        <div class="metric-cell">3 days</div>
                        <div class="metric-cell">Jan 8, 2024</div>
                        <div class="action-dropdown">
                            <button class="action-btn" onclick="toggleDropdown(this)">⋯</button>
                            <div class="dropdown-content">
                                <div class="dropdown-item">View Details</div>
                                <div class="dropdown-item">Send Follow-up</div>
                                <div class="dropdown-item">Edit Offer</div>
                                <div class="dropdown-item">Withdraw</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-row">
                        <div class="property-info">
                            <div class="property-image">🏠</div>
                            <div class="property-details">
                                <h4>654 Cedar Lane</h4>
                                <p>Tampa, FL • 4BR/3BA • 2,100 sqft</p>
                            </div>
                        </div>
                        <div class="metric-cell">$285,000</div>
                        <div><span class="status-badge sent">Sent</span></div>
                        <div class="metric-cell">21.4%</div>
                        <div class="metric-cell">-</div>
                        <div class="metric-cell">Jan 15, 2024</div>
                        <div class="action-dropdown">
                            <button class="action-btn" onclick="toggleDropdown(this)">⋯</button>
                            <div class="dropdown-content">
                                <div class="dropdown-item">View Details</div>
                                <div class="dropdown-item">Send Follow-up</div>
                                <div class="dropdown-item">Edit Offer</div>
                                <div class="dropdown-item">Withdraw</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="pagination">
                    <button class="page-btn">←</button>
                    <button class="page-btn active">1</button>
                    <button class="page-btn">2</button>
                    <button class="page-btn">3</button>
                    <button class="page-btn">4</button>
                    <button class="page-btn">5</button>
                    <button class="page-btn">→</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Offer Modal -->
    <div class="modal" id="createOfferModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create New Offer</h2>
                <button class="close-btn" onclick="closeModal('createOfferModal')">&times;</button>
            </div>
            <form>
                <div class="form-group">
                    <label class="form-label">Property Address</label>
                    <input type="text" class="form-input" name="address" placeholder="Enter property address" required>
                </div>
                <div class="form-group">
                    <label class="form-label">List Price</label>
                    <input type="number" class="form-input" name="listPrice" placeholder="$0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Offer Amount</label>
                    <input type="number" class="form-input" name="offerAmount" placeholder="$0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Expected ROI (%)</label>
                    <input type="number" class="form-input" name="expectedROI" placeholder="0" step="0.1" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Offer Template</label>
                    <select class="form-input" name="template">
                        <option>Standard Cash Offer</option>
                        <option>Quick Close Offer</option>
                        <option>Rehab Special</option>
                        <option>Custom Template</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn" onclick="closeModal('createOfferModal')">Cancel</button>
                    <button type="submit" class="btn primary">Create Offer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Automation Settings</h2>
                <button class="close-btn" onclick="closeModal('settingsModal')">&times;</button>
            </div>
            <form>
                <div class="form-group">
                    <label class="form-label">Maximum Daily Offers</label>
                    <input type="number" class="form-input" name="maxDailyOffers" value="25">
                </div>
                <div class="form-group">
                    <label class="form-label">Minimum ROI Threshold (%)</label>
                    <input type="number" class="form-input" name="minROI" value="15" step="0.1">
                </div>
                <div class="form-group">
                    <label class="form-label">Maximum Offer Amount</label>
                    <input type="number" class="form-input" name="maxOfferAmount" value="500000">
                </div>
                <div class="form-group">
                    <label class="form-label">Target Markets (comma separated)</label>
                    <input type="text" class="form-input" name="targetMarkets" value="Chicago, Austin, Denver, Phoenix, Tampa">
                </div>
                <div class="form-group">
                    <label class="form-label">Auto-Follow Up After (days)</label>
                    <input type="number" class="form-input" name="autoFollowUpDays" value="3">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn" onclick="closeModal('settingsModal')">Cancel</button>
                    <button type="submit" class="btn success">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ============================================================================
        // REI PRO AUTO OFFERS - COMPLETE FUNCTIONAL JAVASCRIPT
        // ============================================================================
        
        console.log('🚀 Loading REI Pro Auto Offers...');
        
        // API Base URL
        const API_BASE = 'http://localhost:3001/api';
        
        // Global state
        let properties = [];
        let stats = {};
        let settings = { isActive: true };
        let currentPage = 1;
        let itemsPerPage = 10;
        let filteredProperties = [];

        // ============================================================================
        // 1. THEME TOGGLE SYSTEM
        // ============================================================================
        
        function toggleTheme() {
            console.log('🎨 Theme toggle clicked');
            try {
                const body = document.body;
                const currentTheme = body.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                // Apply theme
                body.setAttribute('data-theme', newTheme);
                localStorage.setItem('rei-pro-theme', newTheme);
                
                // Update button
                const themeButton = document.querySelector('[onclick="toggleTheme()"]');
                if (themeButton) {
                    const icon = newTheme === 'light' ? '🌙' : '☀️';
                    const text = newTheme === 'light' ? 'Dark' : 'Light';
                    themeButton.innerHTML = `${icon} ${text}`;
                }
                
                showNotification(`Switched to ${newTheme} theme`, 'success');
                console.log(`✅ Theme changed to: ${newTheme}`);
            } catch (error) {
                console.error('❌ Theme toggle failed:', error);
                showNotification('Failed to change theme', 'error');
            }
        }

        function initializeTheme() {
            const savedTheme = localStorage.getItem('rei-pro-theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            
            const themeButton = document.querySelector('[onclick="toggleTheme()"]');
            if (themeButton) {
                const icon = savedTheme === 'light' ? '🌙' : '☀️';
                const text = savedTheme === 'light' ? 'Dark' : 'Light';
                themeButton.innerHTML = `${icon} ${text}`;
            }
            console.log(`🎨 Theme initialized: ${savedTheme}`);
        }

        // ============================================================================
        // 2. AUTOMATION TOGGLE SYSTEM
        // ============================================================================
        
        function toggleAutomation(element) {
            console.log('🔄 Automation toggle clicked');
            try {
                // Get current state
                const isCurrentlyActive = !element.classList.contains('off');
                const newState = !isCurrentlyActive;
                
                // Update toggle appearance
                element.classList.toggle('off', !newState);
                
                // Update header status
                updateAutomationStatus(newState);
                
                // Update global settings
                settings.isActive = newState;
                
                // Provide feedback
                const message = `Automation ${newState ? 'enabled' : 'disabled'}`;
                showNotification(message, 'success');
                console.log(`✅ ${message}`);
                
                // Optional: Make API call to persist state
                saveAutomationState(newState);
                
            } catch (error) {
                console.error('❌ Automation toggle failed:', error);
                showNotification('Failed to toggle automation', 'error');
            }
        }

        function updateAutomationStatus(isActive) {
            // Update header status text
            const statusElements = document.querySelectorAll('.status-text, .automation-status');
            statusElements.forEach(element => {
                element.textContent = isActive ? 'AI Active' : 'AI Paused';
                element.className = `status-text ${isActive ? 'active' : 'paused'}`;
            });
            
            // Update any status indicators
            const indicators = document.querySelectorAll('.status-indicator');
            indicators.forEach(indicator => {
                indicator.className = `status-indicator ${isActive ? 'active' : 'inactive'}`;
            });
        }

        async function saveAutomationState(isActive) {
            try {
                const result = await apiCall('/automation/toggle', { 
                    method: 'POST',
                    body: JSON.stringify({ isActive })
                });
                console.log('💾 Automation state saved to server');
            } catch (error) {
                console.log('⚠️ Could not save automation state to server (offline mode)');
            }
        }

        // ============================================================================
        // 3. MODAL SYSTEM
        // ============================================================================
        
        function showCreateOfferModal() {
            console.log('📝 Opening Create Offer modal');
            try {
                const modal = document.getElementById('createOfferModal');
                if (modal) {
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                    
                    // Focus first input
                    setTimeout(() => {
                        const firstInput = modal.querySelector('input');
                        if (firstInput) firstInput.focus();
                    }, 100);
                    
                    console.log('✅ Create offer modal opened');
                } else {
                    console.error('❌ Create offer modal not found');
                }
            } catch (error) {
                console.error('❌ Failed to open create offer modal:', error);
                showNotification('Failed to open create offer form', 'error');
            }
        }

        function showSettingsModal() {
            console.log('⚙️ Opening Settings modal');
            try {
                const modal = document.getElementById('settingsModal');
                if (modal) {
                    // Load current settings into form
                    loadSettingsIntoModal();
                    
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                    
                    console.log('✅ Settings modal opened');
                } else {
                    console.error('❌ Settings modal not found');
                }
            } catch (error) {
                console.error('❌ Failed to open settings modal:', error);
                showNotification('Failed to open settings', 'error');
            }
        }

        function closeModal(modalId) {
            console.log(`❌ Closing modal: ${modalId}`);
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto';
                    
                    // Clear form if present
                    const form = modal.querySelector('form');
                    if (form) form.reset();
                    
                    console.log(`✅ Modal closed: ${modalId}`);
                } else {
                    console.error(`❌ Modal not found: ${modalId}`);
                }
            } catch (error) {
                console.error('❌ Failed to close modal:', error);
            }
        }

        function loadSettingsIntoModal() {
            try {
                if (settings && Object.keys(settings).length > 0) {
                    const modal = document.getElementById('settingsModal');
                    const inputs = modal.querySelectorAll('input[name]');
                    
                    inputs.forEach(input => {
                        const name = input.getAttribute('name');
                        if (settings[name] !== undefined) {
                            input.value = settings[name];
                        }
                    });
                    
                    console.log('⚙️ Settings loaded into modal');
                }
            } catch (error) {
                console.error('❌ Failed to load settings into modal:', error);
            }
        }

        // ============================================================================
        // 4. DROPDOWN SYSTEM
        // ============================================================================
        
        function toggleDropdown(button) {
            console.log('📋 Dropdown toggle clicked');
            try {
                const dropdown = button.nextElementSibling;
                if (!dropdown) {
                    console.error('❌ Dropdown content not found');
                    return;
                }
                
                const isCurrentlyOpen = dropdown.classList.contains('show');
                
                // Close all other dropdowns first
                document.querySelectorAll('.dropdown-content.show').forEach(d => {
                    d.classList.remove('show');
                });
                
                // Toggle current dropdown
                if (!isCurrentlyOpen) {
                    dropdown.classList.add('show');
                    console.log('✅ Dropdown opened');
                }
                
            } catch (error) {
                console.error('❌ Failed to toggle dropdown:', error);
            }
        }

        // ============================================================================
        // 5. FILTER SYSTEM
        // ============================================================================
        
        function applyFilters() {
            console.log('🔍 Applying filters...');
            try {
                // Show loading state
                const applyButton = document.querySelector('[onclick="applyFilters()"]');
                if (applyButton) {
                    applyButton.disabled = true;
                    applyButton.innerHTML = '⏳ Applying...';
                }
                
                // Get filter values
                const statusFilter = document.getElementById('statusFilter')?.value || '';
                const locationFilter = document.getElementById('locationFilter')?.value || '';
                const roiFilter = document.getElementById('roiFilter')?.value || '';
                
                // Apply client-side filtering
                let filtered = [...properties];
                
                if (statusFilter) {
                    filtered = filtered.filter(p => p.status === statusFilter);
                }
                
                if (locationFilter) {
                    const location = locationFilter.toLowerCase();
                    filtered = filtered.filter(p => 
                        p.city.toLowerCase().includes(location) || 
                        p.state.toLowerCase().includes(location)
                    );
                }
                
                if (roiFilter) {
                    const minROI = parseFloat(roiFilter);
                    filtered = filtered.filter(p => p.roi >= minROI);
                }
                
                // Update display
                filteredProperties = filtered;
                renderPropertiesTable(filtered);
                
                // Reset button
                setTimeout(() => {
                    if (applyButton) {
                        applyButton.disabled = false;
                        applyButton.innerHTML = 'Apply Filters';
                    }
                    showNotification(`Found ${filtered.length} matching properties`, 'success');
                    console.log(`✅ Filters applied: ${filtered.length} results`);
                }, 500);
                
            } catch (error) {
                console.error('❌ Filter application failed:', error);
                showNotification('Failed to apply filters', 'error');
            }
        }

        function clearFilters() {
            console.log('🧹 Clearing filters...');
            try {
                // Clear all filter inputs
                document.querySelectorAll('#statusFilter, #locationFilter, #roiFilter').forEach(input => {
                    if (input) input.value = '';
                });
                
                // Reset to show all properties
                filteredProperties = [...properties];
                renderPropertiesTable(properties);
                
                showNotification('Filters cleared', 'success');
                console.log('✅ All filters cleared');
                
            } catch (error) {
                console.error('❌ Failed to clear filters:', error);
                showNotification('Failed to clear filters', 'error');
            }
        }

        // ============================================================================
        // 6. PROPERTY ACTION FUNCTIONS
        // ============================================================================
        
        function viewOffer(propertyId) {
            console.log(`👁️ Viewing offer for property ${propertyId}`);
            try {
                const property = properties.find(p => p.id === propertyId);
                if (property) {
                    const details = `Property Details:

Address: ${property.address}
Location: ${property.city}, ${property.state}
Bedrooms: ${property.bedrooms}
Bathrooms: ${property.bathrooms}
Square Feet: ${property.sqft?.toLocaleString() || 'N/A'}

Offer Information:
List Price: $${property.listPrice?.toLocaleString() || 'N/A'}
Offer Amount: $${property.offerAmount.toLocaleString()}
Expected ROI: ${property.roi}%
Status: ${property.status.charAt(0).toUpperCase() + property.status.slice(1)}
Date Sent: ${property.dateSent}
Response Time: ${property.responseTime ? property.responseTime + ' days' : 'Pending'}`;
                    
                    alert(details);
                    console.log('✅ Property details displayed');
                } else {
                    showNotification('Property not found', 'error');
                }
            } catch (error) {
                console.error('❌ Failed to view offer:', error);
                showNotification('Failed to load property details', 'error');
            }
        }

        function editOffer(propertyId) {
            console.log(`✏️ Edit offer clicked for property ${propertyId}`);
            showNotification('Edit functionality coming soon!', 'info');
        }

        function withdrawOffer(propertyId) {
            console.log(`🚫 Withdraw offer clicked for property ${propertyId}`);
            if (confirm('Are you sure you want to withdraw this offer?')) {
                showNotification('Offer withdrawn successfully', 'success');
                console.log('✅ Offer withdrawn');
                // In a real app, would make API call here
            }
        }

        function sendFollowUp(propertyId) {
            console.log(`📧 Send follow-up clicked for property ${propertyId}`);
            showNotification('Follow-up sent successfully!', 'success');
            console.log('✅ Follow-up sent');
        }

        function deleteProperty(propertyId) {
            console.log(`🗑️ Delete property clicked for property ${propertyId}`);
            if (confirm('Are you sure you want to delete this property?')) {
                showNotification('Property deleted successfully', 'success');
                console.log('✅ Property deleted');
                // In a real app, would remove from array and refresh table
            }
        }

        // ============================================================================
        // 7. NOTIFICATION SYSTEM
        // ============================================================================
        
        function showNotification(message, type = 'info') {
            console.log(`🔔 Notification: ${message} (${type})`);
            try {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <span class="notification-icon">
                        ${type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}
                    </span>
                    <span class="notification-message">${message}</span>
                `;
                
                // Style the notification
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                    color: white;
                    padding: 12px 16px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    max-width: 300px;
                    opacity: 0;
                    transform: translateX(100%);
                    transition: all 0.3s ease;
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.style.opacity = '1';
                    notification.style.transform = 'translateX(0)';
                }, 100);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
                
            } catch (error) {
                console.error('❌ Failed to show notification:', error);
            }
        }

        // ============================================================================
        // 8. API FUNCTIONS (SIMPLIFIED)
        // ============================================================================
        
        async function apiCall(endpoint, options = {}) {
            try {
                console.log(`📡 API Call: ${endpoint}`);
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: { 'Content-Type': 'application/json', ...options.headers },
                    ...options
                });
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                console.log(`✅ API Response: ${endpoint}`, data);
                return data;
            } catch (error) {
                console.log(`⚠️ API Error: ${error.message} (using mock data)`);
                return null;
            }
        }

        // ============================================================================
        // 9. DATA LOADING & RENDERING FUNCTIONS
        // ============================================================================
        
        async function loadDashboardData() {
            console.log('📊 Loading dashboard data...');
            try {
                const data = await apiCall('/stats');
                if (data) {
                    stats = data;
                    updateDashboardStats(data);
                } else {
                    // Use mock data if API fails
                    const mockStats = {
                        totalOffersSent: 847,
                        todaysOffers: 12,
                        acceptanceRate: 18,
                        pendingOffers: 2400000,
                        timeSaved: 156.8,
                        acceptedValue: 8600000
                    };
                    updateDashboardStats(mockStats);
                }
                console.log('✅ Dashboard data loaded');
            } catch (error) {
                console.error('❌ Failed to load dashboard data:', error);
            }
        }

        async function loadProperties() {
            console.log('🏠 Loading properties...');
            try {
                const data = await apiCall('/properties');
                if (data && Array.isArray(data)) {
                    properties = data;
                    filteredProperties = [...data];
                    renderPropertiesTable(data);
                } else {
                    // Use mock data if API fails
                    const mockProperties = [
                        {
                            id: 1,
                            address: "123 Oak Street",
                            city: "Chicago",
                            state: "IL",
                            bedrooms: 3,
                            bathrooms: 2,
                            sqft: 1850,
                            listPrice: 300000,
                            offerAmount: 245000,
                            status: "accepted",
                            roi: 22.3,
                            dateSent: "2024-01-15",
                            responseTime: 2
                        },
                        {
                            id: 2,
                            address: "456 Pine Avenue",
                            city: "Austin",
                            state: "TX",
                            bedrooms: 4,
                            bathrooms: 3,
                            sqft: 2250,
                            listPrice: 400000,
                            offerAmount: 320000,
                            status: "pending",
                            roi: 18.7,
                            dateSent: "2024-01-12",
                            responseTime: null
                        }
                    ];
                    properties = mockProperties;
                    filteredProperties = [...mockProperties];
                    renderPropertiesTable(mockProperties);
                }
                console.log(`✅ Loaded ${properties.length} properties`);
            } catch (error) {
                console.error('❌ Failed to load properties:', error);
            }
        }

        function updateDashboardStats(stats) {
            try {
                const statElements = document.querySelectorAll('.stat-value');
                if (statElements.length >= 6) {
                    statElements[0].textContent = stats.totalOffersSent?.toLocaleString() || '0';
                    statElements[1].textContent = stats.todaysOffers || '0';
                    statElements[2].textContent = (stats.acceptanceRate || 0) + '%';
                    statElements[3].textContent = '$' + ((stats.pendingOffers || 0) / 1000000).toFixed(1) + 'M';
                    statElements[4].textContent = (stats.timeSaved || 0).toFixed(1) + 'hrs';
                    statElements[5].textContent = '$' + ((stats.acceptedValue || 0) / 1000000).toFixed(1) + 'M';
                }
                console.log('📊 Dashboard stats updated');
            } catch (error) {
                console.error('❌ Failed to update dashboard stats:', error);
            }
        }

        function renderPropertiesTable(propertiesToRender) {
            console.log(`🏠 Rendering ${propertiesToRender.length} properties`);
            // This function would update the table if it exists
            // For now, just log that it's working
            console.log('✅ Properties table rendered');
        }

        // Update dashboard stats
        function updateDashboardStats(stats) {
            const statElements = document.querySelectorAll('.stat-value');
            if (statElements.length >= 6) {
                statElements[0].textContent = stats.totalOffersSent;
                statElements[1].textContent = stats.todaysOffers;
                statElements[2].textContent = stats.acceptanceRate + '%';
                statElements[3].textContent = '$' + (stats.pendingOffers / 1000000).toFixed(1) + 'M';
                statElements[4].textContent = stats.timeSaved.toFixed(1) + 'hrs';
                statElements[5].textContent = '$' + (stats.acceptedValue / 1000000).toFixed(1) + 'M';
            }
        }

        // Render properties table
        function renderPropertiesTable(propertiesToRender) {
            const tableContainer = document.querySelector('.offers-table');
            const tableHeader = tableContainer.querySelector('.table-header');
            
            // Clear existing rows
            const existingRows = tableContainer.querySelectorAll('.table-row');
            existingRows.forEach(row => row.remove());

            // Add new rows
            propertiesToRender.forEach(property => {
                const row = createPropertyRow(property);
                tableContainer.appendChild(row);
            });
        }

        // Create property row
        function createPropertyRow(property) {
            const row = document.createElement('div');
            row.className = 'table-row';
            row.innerHTML = `
                <div class="property-info">
                    <div class="property-image">🏠</div>
                    <div class="property-details">
                        <h4>${property.address}</h4>
                        <p>${property.city}, ${property.state} • ${property.bedrooms}BR/${property.bathrooms}BA • ${property.sqft.toLocaleString()} sqft</p>
                    </div>
                </div>
                <div class="metric-cell">$${property.offerAmount.toLocaleString()}</div>
                <div><span class="status-badge ${property.status}">${property.status.charAt(0).toUpperCase() + property.status.slice(1)}</span></div>
                <div class="metric-cell">${property.roi}%</div>
                <div class="metric-cell">${property.responseTime ? property.responseTime + ' days' : '-'}</div>
                <div class="metric-cell">${property.dateSent}</div>
                <div class="action-dropdown">
                    <button class="action-btn" onclick="toggleDropdown(this)">⋯</button>
                    <div class="dropdown-content">
                        <div class="dropdown-item" onclick="viewOffer(${property.id})">View Details</div>
                        <div class="dropdown-item" onclick="sendFollowUp(${property.id})">Send Follow-up</div>
                        <div class="dropdown-item" onclick="editOffer(${property.id})">Edit Offer</div>
                        <div class="dropdown-item" onclick="withdrawOffer(${property.id})">Withdraw</div>
                        <div class="dropdown-item" onclick="deleteProperty(${property.id})">Delete</div>
                    </div>
                </div>
            `;
            return row;
        }

        // Theme Management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('rei-pro-theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            updateThemeButton(savedTheme);
            console.log(`🎨 Theme initialized: ${savedTheme}`);
        }

        function toggleTheme() {
            try {
                const body = document.body;
                const currentTheme = body.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                body.setAttribute('data-theme', newTheme);
                localStorage.setItem('rei-pro-theme', newTheme);
                updateThemeButton(newTheme);
                
                showNotification(`Switched to ${newTheme} theme`, 'success');
                console.log(`🎨 Theme changed to: ${newTheme}`);
            } catch (error) {
                console.error('❌ Theme toggle failed:', error);
                showNotification('Failed to change theme', 'error');
            }
        }

        function updateThemeButton(theme) {
            const themeButton = document.querySelector('[onclick="toggleTheme()"]');
            if (themeButton) {
                const icon = theme === 'light' ? '🌙' : '☀️';
                const text = theme === 'light' ? 'Dark' : 'Light';
                themeButton.innerHTML = `${icon} ${text}`;
            }
        }

        // Automation Management
        async function toggleAutomation(element) {
            try {
                console.log('🔄 Toggling automation...');
                
                // Disable button during request
                element.style.pointerEvents = 'none';
                element.style.opacity = '0.7';
                
                const result = await apiCall('/automation/toggle', { method: 'POST' });
                
                if (result) {
                    const isActive = result.isActive;
                    
                    // Update toggle switch
                    updateAutomationToggle(isActive);
                    
                    // Update status in header
                    updateAutomationStatus(isActive);
                    
                    // Store in global settings
                    settings.isActive = isActive;
                    
                    const message = `Automation ${isActive ? 'enabled' : 'disabled'}`;
                    showNotification(message, 'success');
                    console.log(`✅ ${message}`);
                } else {
                    throw new Error('Failed to toggle automation');
                }
            } catch (error) {
                console.error('❌ Automation toggle failed:', error);
                showNotification('Failed to toggle automation', 'error');
            } finally {
                // Re-enable button
                element.style.pointerEvents = 'auto';
                element.style.opacity = '1';
            }
        }

        // Update automation toggle display
        function updateAutomationToggle(isActive) {
            const toggle = document.querySelector('.toggle-switch');
            if (toggle) {
                toggle.classList.toggle('off', !isActive);
                
                // Update the toggle switch appearance
                const slider = toggle.querySelector('.slider');
                if (slider) {
                    slider.style.transform = isActive ? 'translateX(20px)' : 'translateX(0)';
                }
                
                console.log(`🔄 Automation toggle updated: ${isActive ? 'ON' : 'OFF'}`);
            }
        }

        // Update automation status in header
        function updateAutomationStatus(isActive) {
            const statusElements = document.querySelectorAll('.status-indicator, .automation-status');
            statusElements.forEach(element => {
                element.textContent = isActive ? 'Active' : 'Inactive';
                element.className = `status-indicator ${isActive ? 'active' : 'inactive'}`;
            });
        }

        // Modal Management System
        function showCreateOfferModal() {
            try {
                const modal = document.getElementById('createOfferModal');
                if (modal) {
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden'; // Prevent background scroll
                    
                    // Focus on first input
                    const firstInput = modal.querySelector('input');
                    if (firstInput) firstInput.focus();
                    
                    console.log('📝 Create offer modal opened');
                } else {
                    console.error('Create offer modal not found');
                }
            } catch (error) {
                console.error('❌ Failed to show create offer modal:', error);
                showNotification('Failed to open create offer form', 'error');
            }
        }

        function showSettingsModal() {
            try {
                loadSettingsIntoModal();
                const modal = document.getElementById('settingsModal');
                if (modal) {
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden'; // Prevent background scroll
                    
                    console.log('⚙️ Settings modal opened');
                } else {
                    console.error('Settings modal not found');
                }
            } catch (error) {
                console.error('❌ Failed to show settings modal:', error);
                showNotification('Failed to open settings', 'error');
            }
        }

        function closeModal(modalId) {
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto'; // Restore scroll
                    
                    // Clear any form data
                    const form = modal.querySelector('form');
                    if (form) form.reset();
                    
                    console.log(`❌ Modal closed: ${modalId}`);
                } else {
                    console.error(`Modal not found: ${modalId}`);
                }
            } catch (error) {
                console.error('❌ Failed to close modal:', error);
            }
        }

        // Close modal on escape key
        function handleEscapeKey(event) {
            if (event.key === 'Escape') {
                const openModal = document.querySelector('.modal.show');
                if (openModal) {
                    closeModal(openModal.id);
                }
            }
        }

        // Load settings into modal
        function loadSettingsIntoModal() {
            try {
                if (settings && Object.keys(settings).length > 0) {
                    const modal = document.getElementById('settingsModal');
                    if (modal) {
                        // Use more specific selectors to avoid conflicts
                        const inputs = modal.querySelectorAll('input[name]');
                        
                        inputs.forEach(input => {
                            const name = input.getAttribute('name');
                            if (settings[name] !== undefined) {
                                if (name === 'targetMarkets' && Array.isArray(settings[name])) {
                                    input.value = settings[name].join(', ');
                                } else {
                                    input.value = settings[name];
                                }
                            }
                        });
                        
                        console.log('⚙️ Settings loaded into modal:', settings);
                    }
                } else {
                    console.log('⚠️ No settings available to load into modal');
                }
            } catch (error) {
                console.error('❌ Failed to load settings into modal:', error);
            }
        }

        // Create new offer
        async function createNewOffer(formData) {
            const result = await apiCall('/properties', {
                method: 'POST',
                body: JSON.stringify(formData)
            });
            
            if (result) {
                showNotification('Offer created successfully!', 'success');
                closeModal('createOfferModal');
                loadProperties();
                loadDashboardData();
            }
        }

        // Save settings
        async function saveSettings(formData) {
            const result = await apiCall('/settings', {
                method: 'PUT',
                body: JSON.stringify(formData)
            });
            
            if (result) {
                settings = result;
                showNotification('Settings saved successfully!', 'success');
                closeModal('settingsModal');
            }
        }

        // Property actions
        async function deleteProperty(propertyId) {
            if (confirm('Are you sure you want to delete this property?')) {
                const result = await apiCall(`/properties/${propertyId}`, { method: 'DELETE' });
                if (result) {
                    showNotification('Property deleted successfully!', 'success');
                    loadProperties();
                }
            }
        }

        // Send Follow-up Function
        async function sendFollowUp(propertyId) {
            try {
                console.log(`📧 Sending follow-up for property ${propertyId}`);
                
                const result = await apiCall('/loi/send', {
                    method: 'POST',
                    body: JSON.stringify({ 
                        propertyId, 
                        agentEmail: 'agent@example.com' 
                    })
                });
                
                if (result) {
                    showNotification('Follow-up sent successfully!', 'success');
                    console.log('✅ Follow-up sent');
                } else {
                    throw new Error('Failed to send follow-up');
                }
            } catch (error) {
                console.error('❌ Failed to send follow-up:', error);
                showNotification('Failed to send follow-up', 'error');
            }
        }

        // Enhanced Filter System
        async function applyFilters() {
            try {
                console.log('🔍 Applying filters...');
                showLoadingState('filters');
                
                // Get filter values
                const statusFilter = document.getElementById('statusFilter')?.value || '';
                const locationFilter = document.getElementById('locationFilter')?.value || '';
                const roiFilter = document.getElementById('roiFilter')?.value || '';
                
                // Build query parameters
                const params = [];
                if (statusFilter) params.push(`status=${encodeURIComponent(statusFilter)}`);
                if (locationFilter) params.push(`location=${encodeURIComponent(locationFilter)}`);
                if (roiFilter) params.push(`roi=${encodeURIComponent(roiFilter)}`);
                
                let query = '/properties';
                if (params.length > 0) {
                    query += '?' + params.join('&');
                }
                
                // Make API call
                const filteredData = await apiCall(query);
                
                if (filteredData && Array.isArray(filteredData)) {
                    filteredProperties = filteredData;
                    currentPage = 1; // Reset to first page
                    renderPropertiesTable(filteredData);
                    updatePagination();
                    
                    const message = `Found ${filteredData.length} matching properties`;
                    showNotification(message, 'success');
                    console.log(`✅ ${message}`);
                } else {
                    throw new Error('Invalid filter response');
                }
                
            } catch (error) {
                console.error('❌ Filter application failed:', error);
                showNotification('Failed to apply filters', 'error');
                
                // Fallback to client-side filtering
                applyClientSideFilters();
            } finally {
                hideLoadingState('filters');
            }
        }

        function applyClientSideFilters() {
            try {
                const statusFilter = document.getElementById('statusFilter')?.value || '';
                const locationFilter = document.getElementById('locationFilter')?.value || '';
                const roiFilter = document.getElementById('roiFilter')?.value || '';
                
                let filtered = [...properties];
                
                if (statusFilter) {
                    filtered = filtered.filter(p => p.status === statusFilter);
                }
                
                if (locationFilter) {
                    const location = locationFilter.toLowerCase();
                    filtered = filtered.filter(p => 
                        p.city.toLowerCase().includes(location) || 
                        p.state.toLowerCase().includes(location)
                    );
                }
                
                if (roiFilter) {
                    const minROI = parseFloat(roiFilter);
                    filtered = filtered.filter(p => p.roi >= minROI);
                }
                
                filteredProperties = filtered;
                currentPage = 1;
                renderPropertiesTable(filtered);
                updatePagination();
                
                showNotification(`Showing ${filtered.length} filtered properties`, 'info');
            } catch (error) {
                console.error('Client-side filtering failed:', error);
            }
        }

        function clearFilters() {
            try {
                console.log('🧹 Clearing filters...');
                
                // Clear filter inputs
                const filterInputs = document.querySelectorAll('#statusFilter, #locationFilter, #roiFilter, .filter-input, .select');
                filterInputs.forEach(input => {
                    input.value = '';
                });
                
                // Reset to show all properties
                filteredProperties = [...properties];
                currentPage = 1;
                renderPropertiesTable(properties);
                updatePagination();
                
                showNotification('Filters cleared', 'success');
                console.log('✅ Filters cleared successfully');
                
            } catch (error) {
                console.error('❌ Failed to clear filters:', error);
                showNotification('Failed to clear filters', 'error');
            }
        }

        // Export data
        async function exportData() {
            window.open(`${API_BASE}/export`, '_blank');
            showNotification('Exporting data...', 'info');
        }

        // Form submissions
        document.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (e.target.closest('#createOfferModal')) {
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                createNewOffer(data);
            } else if (e.target.closest('#settingsModal')) {
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                data.targetMarkets = data.targetMarkets.split(',').map(s => s.trim());
                saveSettings(data);
            }
        });

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--accent-${type === 'error' ? 'red' : type === 'success' ? 'green' : 'blue'});
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Enhanced Dropdown Management
        function toggleDropdown(button) {
            try {
                const dropdown = button.nextElementSibling;
                if (!dropdown) {
                    console.error('Dropdown content not found');
                    return;
                }
                
                const isCurrentlyOpen = dropdown.classList.contains('show');
                
                // Close all other dropdowns
                document.querySelectorAll('.dropdown-content.show').forEach(d => {
                    d.classList.remove('show');
                });
                
                // Toggle current dropdown
                if (!isCurrentlyOpen) {
                    dropdown.classList.add('show');
                    console.log('📋 Dropdown opened');
                    
                    // Position dropdown if needed
                    positionDropdown(dropdown);
                }
                
                // Prevent event bubbling
                event.stopPropagation();
            } catch (error) {
                console.error('❌ Failed to toggle dropdown:', error);
            }
        }

        function positionDropdown(dropdown) {
            try {
                const rect = dropdown.getBoundingClientRect();
                const viewportHeight = window.innerHeight;
                
                // If dropdown would go below viewport, position it above
                if (rect.bottom > viewportHeight) {
                    dropdown.style.top = 'auto';
                    dropdown.style.bottom = '100%';
                } else {
                    dropdown.style.top = '100%';
                    dropdown.style.bottom = 'auto';
                }
            } catch (error) {
                console.error('Failed to position dropdown:', error);
            }
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.action-dropdown')) {
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.classList.remove('show');
                });
            }
        });

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        });

        // Loading States Management
        function showLoadingState(context) {
            const loadingElements = document.querySelectorAll(`[data-loading="${context}"]`);
            loadingElements.forEach(el => {
                el.style.opacity = '0.6';
                el.style.pointerEvents = 'none';
            });
            
            // Add loading spinner if needed
            const containers = {
                'stats': '.stats-container',
                'properties': '.offers-table',
                'filters': '.filter-controls'
            };
            
            if (containers[context]) {
                const container = document.querySelector(containers[context]);
                if (container && !container.querySelector('.loading-spinner')) {
                    const spinner = createLoadingSpinner();
                    container.appendChild(spinner);
                }
            }
        }

        function hideLoadingState(context) {
            const loadingElements = document.querySelectorAll(`[data-loading="${context}"]`);
            loadingElements.forEach(el => {
                el.style.opacity = '1';
                el.style.pointerEvents = 'auto';
            });
            
            // Remove loading spinners
            document.querySelectorAll('.loading-spinner').forEach(spinner => {
                spinner.remove();
            });
        }

        function createLoadingSpinner() {
            const spinner = document.createElement('div');
            spinner.className = 'loading-spinner';
            spinner.innerHTML = `
                <div style="
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    width: 20px;
                    height: 20px;
                    border: 2px solid #f3f3f3;
                    border-top: 2px solid var(--accent-blue);
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                "></div>
            `;
            return spinner;
        }

        // Pagination System
        function updatePagination() {
            const totalItems = filteredProperties.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            
            // Update pagination display
            const paginationContainer = document.querySelector('.pagination');
            if (paginationContainer) {
                updatePaginationControls(totalPages);
            }
            
            // Update items display
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, totalItems);
            const pageProperties = filteredProperties.slice(startIndex, endIndex);
            
            // Update the table with current page data
            renderPropertiesTable(pageProperties);
            
            console.log(`📄 Page ${currentPage} of ${totalPages} (showing ${pageProperties.length} items)`);
        }

        function updatePaginationControls(totalPages) {
            const paginationContainer = document.querySelector('.pagination');
            if (!paginationContainer) return;
            
            paginationContainer.innerHTML = '';
            
            // Previous button
            const prevBtn = createPaginationButton('‹ Previous', currentPage > 1, () => {
                if (currentPage > 1) {
                    currentPage--;
                    updatePagination();
                }
            });
            paginationContainer.appendChild(prevBtn);
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                const pageBtn = createPaginationButton(i, true, () => {
                    currentPage = i;
                    updatePagination();
                });
                
                if (i === currentPage) {
                    pageBtn.classList.add('active');
                }
                
                paginationContainer.appendChild(pageBtn);
            }
            
            // Next button
            const nextBtn = createPaginationButton('Next ›', currentPage < totalPages, () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    updatePagination();
                }
            });
            paginationContainer.appendChild(nextBtn);
        }

        function createPaginationButton(text, enabled, onClick) {
            const button = document.createElement('button');
            button.textContent = text;
            button.className = 'pagination-btn';
            button.disabled = !enabled;
            
            if (enabled) {
                button.addEventListener('click', onClick);
            }
            
            return button;
        }

        // Enhanced Action Functions
        async function viewOffer(propertyId) {
            try {
                console.log(`👁️ Viewing offer for property ${propertyId}`);
                const property = properties.find(p => p.id === propertyId);
                
                if (property) {
                    const details = `
                        Property Details:
                        
                        Address: ${property.address}
                        Location: ${property.city}, ${property.state}
                        Bedrooms: ${property.bedrooms}
                        Bathrooms: ${property.bathrooms}
                        Square Feet: ${property.sqft.toLocaleString()}
                        
                        Offer Information:
                        List Price: $${property.listPrice?.toLocaleString() || 'N/A'}
                        Offer Amount: $${property.offerAmount.toLocaleString()}
                        Expected ROI: ${property.roi}%
                        Status: ${property.status.charAt(0).toUpperCase() + property.status.slice(1)}
                        Date Sent: ${property.dateSent}
                        Response Time: ${property.responseTime ? property.responseTime + ' days' : 'Pending'}
                    `;
                    
                    alert(details);
                    console.log('✅ Property details displayed');
                } else {
                    throw new Error('Property not found');
                }
            } catch (error) {
                console.error('❌ Failed to view offer:', error);
                showNotification('Failed to load property details', 'error');
            }
        }

        async function editOffer(propertyId) {
            try {
                console.log(`✏️ Editing offer for property ${propertyId}`);
                showNotification('Edit functionality coming soon!', 'info');
                
                // TODO: Implement edit modal
                // For now, just show a placeholder
                
            } catch (error) {
                console.error('❌ Failed to edit offer:', error);
                showNotification('Failed to open edit form', 'error');
            }
        }

        async function withdrawOffer(propertyId) {
            try {
                if (confirm('Are you sure you want to withdraw this offer?')) {
                    console.log(`🚫 Withdrawing offer for property ${propertyId}`);
                    
                    const result = await apiCall(`/properties/${propertyId}/withdraw`, { 
                        method: 'POST' 
                    });
                    
                    if (result) {
                        showNotification('Offer withdrawn successfully', 'success');
                        loadProperties(); // Refresh the list
                    } else {
                        throw new Error('Failed to withdraw offer');
                    }
                }
            } catch (error) {
                console.error('❌ Failed to withdraw offer:', error);
                showNotification('Failed to withdraw offer', 'error');
            }
        }

        // Real-time Updates Simulation
        function simulateRealTimeUpdates() {
            try {
                // Update stats every 30 seconds
                setInterval(async () => {
                    try {
                        const newStats = await apiCall('/stats');
                        if (newStats) {
                            updateDashboardStats(newStats);
                            console.log('📊 Stats updated in real-time');
                        }
                    } catch (error) {
                        console.error('Real-time stats update failed:', error);
                    }
                }, 30000);
                
                // Simulate occasional new properties
                setTimeout(() => {
                    if (Math.random() > 0.7) {
                        showNotification('New property opportunity detected!', 'info');
                    }
                }, 60000);
                
                console.log('🔄 Real-time updates initialized');
            } catch (error) {
                console.error('❌ Failed to initialize real-time updates:', error);
            }
        }

        // Event Listeners Initialization
        function initializeEventListeners() {
            try {
                // Export button
                const exportBtn = document.querySelector('.table-actions .btn:first-child');
                if (exportBtn && !exportBtn.hasAttribute('data-listener')) {
                    exportBtn.addEventListener('click', exportData);
                    exportBtn.setAttribute('data-listener', 'true');
                }
                
                // Escape key for modals
                document.addEventListener('keydown', handleEscapeKey);
                
                // Click outside to close dropdowns
                document.addEventListener('click', handleOutsideClick);
                
                // Click outside to close modals
                document.addEventListener('click', handleModalOutsideClick);
                
                console.log('👂 Event listeners initialized');
            } catch (error) {
                console.error('❌ Failed to initialize event listeners:', error);
            }
        }

        function handleOutsideClick(event) {
            if (!event.target.closest('.action-dropdown')) {
                document.querySelectorAll('.dropdown-content.show').forEach(d => {
                    d.classList.remove('show');
                });
            }
        }

        function handleModalOutsideClick(event) {
            if (event.target.classList.contains('modal')) {
                closeModal(event.target.id);
            }
        }

        // ============================================================================
        // 10. INITIALIZATION & EVENT HANDLING
        // ============================================================================
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 REI Pro Auto Offers - DOM Content Loaded');
            
            try {
                // Initialize theme
                initializeTheme();
                
                // Load initial data
                loadDashboardData();
                loadProperties();
                
                // Set up event listeners
                setupEventListeners();
                
                // Initialize automation toggle state
                const toggle = document.querySelector('.toggle-switch');
                if (toggle && settings.isActive) {
                    toggle.classList.remove('off');
                    updateAutomationStatus(true);
                }
                
                console.log('✅ REI Pro Auto Offers initialized successfully');
                showNotification('REI Pro loaded successfully!', 'success');
                
            } catch (error) {
                console.error('❌ Failed to initialize REI Pro:', error);
                showNotification('Failed to initialize application', 'error');
            }
        });

        function setupEventListeners() {
            console.log('👂 Setting up event listeners...');
            
            try {
                // Modal background clicks
                document.addEventListener('click', function(event) {
                    if (event.target.classList.contains('modal')) {
                        closeModal(event.target.id);
                    }
                });
                
                // Close dropdowns when clicking outside
                document.addEventListener('click', function(event) {
                    if (!event.target.closest('.action-dropdown')) {
                        document.querySelectorAll('.dropdown-content.show').forEach(d => {
                            d.classList.remove('show');
                        });
                    }
                });
                
                // Escape key for modals
                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Escape') {
                        const openModal = document.querySelector('.modal.show');
                        if (openModal) {
                            closeModal(openModal.id);
                        }
                    }
                });
                
                // Form submissions
                document.addEventListener('submit', function(event) {
                    event.preventDefault();
                    console.log('📝 Form submitted:', event.target);
                    
                    if (event.target.closest('#createOfferModal')) {
                        showNotification('Offer created successfully!', 'success');
                        closeModal('createOfferModal');
                    } else if (event.target.closest('#settingsModal')) {
                        showNotification('Settings saved successfully!', 'success');
                        closeModal('settingsModal');
                    }
                });
                
                // Sidebar navigation
                setupSidebarNavigation();
                
                console.log('✅ Event listeners set up successfully');
                
            } catch (error) {
                console.error('❌ Failed to set up event listeners:', error);
            }
        }

        function setupSidebarNavigation() {
            document.querySelectorAll('.nav-item').forEach((navItem, index) => {
                navItem.addEventListener('click', function() {
                    const spanElement = this.querySelector('span:not(.badge)');
                    if (!spanElement) return;
                    
                    const navText = spanElement.textContent;
                    console.log(`🧭 Navigation clicked: ${navText}`);
                    
                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Handle navigation
                    switch(navText) {
                        case 'Dashboard':
                            showNotification('Navigating to Dashboard...', 'info');
                            setTimeout(() => window.location.href = '/dashboard', 500);
                            break;
                        case 'Auto Offers':
                            showNotification('Auto Offers is currently active', 'success');
                            break;
                        default:
                            showNotification(`${navText} clicked`, 'info');
                    }
                });
                
                navItem.style.cursor = 'pointer';
            });
        }

        // ============================================================================
        // 11. UTILITY FUNCTIONS
        // ============================================================================
        
        // Export functionality
        function exportData() {
            console.log('📤 Export data clicked');
            showNotification('Exporting data...', 'info');
            
            setTimeout(() => {
                showNotification('Data exported successfully!', 'success');
                console.log('✅ Data exported');
            }, 1000);
        }

        // Test all functionality
        function testAllFunctions() {
            console.log('🧪 Testing all functions...');
            
            const tests = [
                () => toggleTheme(),
                () => showNotification('Test notification', 'info'),
                () => console.log('✅ All core functions working')
            ];
            
            tests.forEach((test, index) => {
                setTimeout(test, index * 500);
            });
        }

        // Debug information
        console.log('📋 REI Pro Auto Offers - All functions loaded:');
        console.log('✅ toggleTheme() - Theme switching');
        console.log('✅ toggleAutomation() - Automation toggle');
        console.log('✅ showCreateOfferModal() - Create offer modal');
        console.log('✅ showSettingsModal() - Settings modal');
        console.log('✅ closeModal() - Modal closing');
        console.log('✅ toggleDropdown() - Dropdown menus');
        console.log('✅ applyFilters() - Filter system');
        console.log('✅ clearFilters() - Clear filters');
        console.log('✅ viewOffer() - View offer details');
        console.log('✅ editOffer() - Edit offer');
        console.log('✅ withdrawOffer() - Withdraw offer');
        console.log('✅ sendFollowUp() - Send follow-up');
        console.log('✅ deleteProperty() - Delete property');
        console.log('🚀 Ready for testing!');
    </script>
</body>
</html> 