<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REI Pro - Properties</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light Mode Colors */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-purple: #8b5cf6;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border-color: #334155;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            -webkit-font-smoothing: antialiased;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar - Same as Dashboard */
        .sidebar {
            width: 260px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            padding: 20px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            margin-bottom: 32px;
            border-radius: 12px;
            background: var(--accent-blue);
            color: white;
        }

        .logo-icon {
            font-size: 28px;
            font-weight: bold;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
        }

        .nav-section {
            margin-bottom: 32px;
        }

        .nav-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 12px;
            padding: 0 16px;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            margin-bottom: 4px;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--accent-blue);
            color: white;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .nav-badge {
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 20px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .breadcrumb {
            color: var(--text-muted);
            font-size: 14px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-blue);
        }

        .btn.primary {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .btn.success {
            background: var(--accent-green);
            color: white;
            border-color: var(--accent-green);
        }

        /* Page Content */
        .page-content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            background: var(--bg-secondary);
        }

        /* Search Section */
        .search-section {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .search-header {
            display: flex;
            align-items: center;
            justify-content: between;
            margin-bottom: 24px;
        }

        .search-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .search-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-input, .form-select {
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Properties Grid */
        .properties-section {
            margin-bottom: 32px;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: between;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .view-toggle {
            display: flex;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .view-btn {
            padding: 8px 16px;
            border: none;
            background: var(--bg-primary);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .view-btn.active {
            background: var(--accent-blue);
            color: white;
        }

        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
        }

        .property-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .property-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
            border-color: var(--accent-blue);
        }

        .property-image {
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
        }

        .property-status {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .status-available {
            background: var(--accent-green);
        }

        .status-pending {
            background: var(--accent-orange);
        }

        .status-sold {
            background: var(--accent-red);
        }

        .property-content {
            padding: 20px;
        }

        .property-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .property-address {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .property-location {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .property-details {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .property-metric {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .property-roi {
            background: var(--accent-green);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 16px;
            display: inline-block;
        }

        .property-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }

        /* Deal Calculator Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-primary);
            border-radius: 16px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: between;
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-muted);
            cursor: pointer;
        }

        .modal-body {
            padding: 24px;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        .calc-section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
        }

        .calc-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .calc-result {
            background: var(--accent-blue);
            color: white;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            margin-top: 16px;
        }

        .calc-result-value {
            font-size: 24px;
            font-weight: 800;
        }

        .calc-result-label {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Table View */
        .properties-table {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
        }

        .table-header {
            background: var(--bg-tertiary);
            padding: 16px 24px;
            font-weight: 600;
            color: var(--text-secondary);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 120px;
            gap: 16px;
            align-items: center;
        }

        .table-row {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 120px;
            gap: 16px;
            align-items: center;
            transition: all 0.2s ease;
        }

        .table-row:hover {
            background: var(--bg-tertiary);
        }

        .table-row:last-child {
            border-bottom: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -260px;
                top: 0;
                height: 100vh;
                z-index: 1000;
            }

            .sidebar.open {
                left: 0;
            }

            .page-content {
                padding: 20px;
            }

            .search-grid {
                grid-template-columns: 1fr;
            }

            .properties-grid {
                grid-template-columns: 1fr;
            }

            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .table-header, .table-row {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }

        /* Animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .property-card {
            animation: slideIn 0.5s ease forwards;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--accent-green);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
    </style>
</head>
<body data-theme="light">
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <div class="logo-icon">🏠</div>
                <div class="logo-text">REI Pro</div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Platform</div>
                <a href="rei-dashboard.html" class="nav-item">
                    <div class="nav-icon">📊</div>
                    <span>Dashboard</span>
                </a>
                <a href="index.html" class="nav-item">
                    <div class="nav-icon">🎯</div>
                    <span>Auto Offers</span>
                    <span class="nav-badge">24</span>
                </a>
                <a href="properties.html" class="nav-item active">
                    <div class="nav-icon">🏘️</div>
                    <span>Properties</span>
                </a>
                <a href="analytics.html" class="nav-item">
                    <div class="nav-icon">📈</div>
                    <span>Analytics</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">Management</div>
                <a href="contacts.html" class="nav-item">
                    <div class="nav-icon">👥</div>
                    <span>Contacts</span>
                </a>
                <a href="finances.html" class="nav-item">
                    <div class="nav-icon">💰</div>
                    <span>Finances</span>
                </a>
                <a href="documents.html" class="nav-item">
                    <div class="nav-icon">📄</div>
                    <span>Documents</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <div class="nav-icon">⚙️</div>
                    <span>Settings</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <button class="btn" onclick="toggleSidebar()">☰</button>
                    <div>
                        <h1 class="page-title">Properties</h1>
                        <div class="breadcrumb">Search / Analysis / Management</div>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="toggleTheme()">🌙 Theme</button>
                    <button class="btn primary" onclick="showImportModal()">📥 Import</button>
                    <button class="btn success" onclick="showAddPropertyModal()">➕ Add Property</button>
                </div>
            </div>

            <!-- Page Content -->
            <div class="page-content">
                <!-- Search Section -->
                <div class="search-section">
                    <div class="search-header">
                        <h3 class="search-title">Property Search & Filters</h3>
                        <button class="btn" onclick="showAdvancedSearch()">🔍 Advanced</button>
                    </div>
                    
                    <div class="search-grid">
                        <div class="form-group">
                            <label class="form-label">Location</label>
                            <input type="text" class="form-input" id="searchLocation" placeholder="City, State, or ZIP">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Price Range</label>
                            <select class="form-select" id="priceRange">
                                <option value="">Any Price</option>
                                <option value="0-200000">Under $200k</option>
                                <option value="200000-400000">$200k - $400k</option>
                                <option value="400000-600000">$400k - $600k</option>
                                <option value="600000-999999">$600k+</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Property Type</label>
                            <select class="form-select" id="propertyType">
                                <option value="">All Types</option>
                                <option value="single-family">Single Family</option>
                                <option value="multi-family">Multi-Family</option>
                                <option value="condo">Condo</option>
                                <option value="commercial">Commercial</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Min ROI %</label>
                            <input type="number" class="form-input" id="minROI" placeholder="15" min="0" max="100">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Bedrooms</label>
                            <select class="form-select" id="bedrooms">
                                <option value="">Any</option>
                                <option value="1">1+</option>
                                <option value="2">2+</option>
                                <option value="3">3+</option>
                                <option value="4">4+</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="status">
                                <option value="">All Status</option>
                                <option value="available">Available</option>
                                <option value="pending">Pending</option>
                                <option value="sold">Sold</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="search-actions">
                        <button class="btn" onclick="clearSearch()">Clear</button>
                        <button class="btn" onclick="saveSearch()">💾 Save Search</button>
                        <button class="btn primary" onclick="searchProperties()">🔍 Search</button>
                    </div>
                </div>

                <!-- Properties Section -->
                <div class="properties-section">
                    <div class="section-header">
                        <h3 class="section-title">Investment Opportunities</h3>
                        <div class="view-toggle">
                            <button class="view-btn active" onclick="setView('grid')">🗃️ Grid</button>
                            <button class="view-btn" onclick="setView('table')">📋 Table</button>
                        </div>
                    </div>

                    <!-- Grid View -->
                    <div class="properties-grid" id="gridView">
                        <!-- Property Cards Will Be Generated Here -->
                    </div>

                    <!-- Table View -->
                    <div class="properties-table" id="tableView" style="display: none;">
                        <div class="table-header">
                            <div>Property</div>
                            <div>Price</div>
                            <div>ROI</div>
                            <div>Status</div>
                            <div>Details</div>
                            <div>Actions</div>
                        </div>
                        <!-- Table Rows Will Be Generated Here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Deal Calculator Modal -->
    <div class="modal" id="calculatorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Deal Calculator</h3>
                <button class="close-btn" onclick="closeModal('calculatorModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="calculator-grid">
                    <div class="calc-section">
                        <h4 class="calc-title">Property Details</h4>
                        <div class="form-group">
                            <label class="form-label">Purchase Price</label>
                            <input type="number" class="form-input" id="purchasePrice" placeholder="300000" onchange="calculateDeal()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Down Payment %</label>
                            <input type="number" class="form-input" id="downPayment" placeholder="20" onchange="calculateDeal()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Interest Rate %</label>
                            <input type="number" class="form-input" id="interestRate" placeholder="6.5" step="0.1" onchange="calculateDeal()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Loan Term (years)</label>
                            <input type="number" class="form-input" id="loanTerm" placeholder="30" onchange="calculateDeal()">
                        </div>
                    </div>

                    <div class="calc-section">
                        <h4 class="calc-title">Income & Expenses</h4>
                        <div class="form-group">
                            <label class="form-label">Monthly Rent</label>
                            <input type="number" class="form-input" id="monthlyRent" placeholder="2500" onchange="calculateDeal()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Property Taxes (annual)</label>
                            <input type="number" class="form-input" id="propertyTaxes" placeholder="3600" onchange="calculateDeal()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Insurance (annual)</label>
                            <input type="number" class="form-input" id="insurance" placeholder="1200" onchange="calculateDeal()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Maintenance/Repairs %</label>
                            <input type="number" class="form-input" id="maintenance" placeholder="10" onchange="calculateDeal()">
                        </div>
                    </div>
                </div>

                <div class="calculator-grid">
                    <div class="calc-result">
                        <div class="calc-result-value" id="monthlyROI">--</div>
                        <div class="calc-result-label">Monthly Cash Flow</div>
                    </div>
                    <div class="calc-result">
                        <div class="calc-result-value" id="annualROI">--</div>
                        <div class="calc-result-label">Annual ROI %</div>
                    </div>
                </div>

                <div style="margin-top: 24px; text-align: right;">
                    <button class="btn" onclick="closeModal('calculatorModal')">Close</button>
                    <button class="btn primary" onclick="saveCalculation()">💾 Save Analysis</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================================================
        // REI PRO SAAS PLATFORM - PROPERTIES MODULE
        // ============================================================================
        
        console.log('🏘️ REI Pro Properties Loading...');

        // Global state
        let currentTheme = localStorage.getItem('rei-pro-theme') || 'light';
        let currentView = 'grid';
        let properties = [];
        let filteredProperties = [];

        // Sample property data
        const sampleProperties = [
            {
                id: 1,
                address: "123 Oak Street",
                city: "Chicago",
                state: "IL",
                price: 245000,
                bedrooms: 3,
                bathrooms: 2,
                sqft: 1850,
                type: "single-family",
                status: "available",
                roi: 22.3,
                image: "🏠",
                description: "Beautiful single-family home in prime location",
                yearBuilt: 1995,
                lotSize: 0.25
            },
            {
                id: 2,
                address: "456 Pine Avenue",
                city: "Austin",
                state: "TX",
                price: 320000,
                bedrooms: 4,
                bathrooms: 3,
                sqft: 2250,
                type: "single-family",
                status: "pending",
                roi: 18.7,
                image: "🏡",
                description: "Modern home with open floor plan",
                yearBuilt: 2010,
                lotSize: 0.35
            },
            {
                id: 3,
                address: "789 Maple Drive",
                city: "Denver",
                state: "CO",
                price: 185000,
                bedrooms: 2,
                bathrooms: 2,
                sqft: 1200,
                type: "condo",
                status: "available",
                roi: 24.5,
                image: "🏢",
                description: "Downtown condo with city views",
                yearBuilt: 2005,
                lotSize: 0
            },
            {
                id: 4,
                address: "321 Elm Street",
                city: "Phoenix",
                state: "AZ",
                price: 280000,
                bedrooms: 3,
                bathrooms: 2.5,
                sqft: 1950,
                type: "single-family",
                status: "available",
                roi: 19.8,
                image: "🏠",
                description: "Desert oasis with pool",
                yearBuilt: 2000,
                lotSize: 0.4
            },
            {
                id: 5,
                address: "654 Cedar Lane",
                city: "Tampa",
                state: "FL",
                price: 195000,
                bedrooms: 3,
                bathrooms: 2,
                sqft: 1600,
                type: "single-family",
                status: "sold",
                roi: 21.2,
                image: "🏘️",
                description: "Family-friendly neighborhood",
                yearBuilt: 1990,
                lotSize: 0.3
            },
            {
                id: 6,
                address: "987 Birch Court",
                city: "Atlanta",
                state: "GA",
                price: 425000,
                bedrooms: 5,
                bathrooms: 4,
                sqft: 3200,
                type: "multi-family",
                status: "available",
                roi: 16.4,
                image: "🏘️",
                description: "Duplex investment opportunity",
                yearBuilt: 2015,
                lotSize: 0.5
            }
        ];

        // ============================================================================
        // INITIALIZATION
        // ============================================================================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🏘️ Properties module initializing...');
            
            try {
                // Initialize theme
                initializeTheme();
                
                // Load properties
                loadProperties();
                
                // Render properties
                renderProperties();
                
                // Show welcome notification
                showNotification('Properties module loaded!', 'success');
                
                console.log('✅ Properties module initialized successfully');
            } catch (error) {
                console.error('❌ Properties initialization failed:', error);
                showNotification('Failed to load properties', 'error');
            }
        });

        // ============================================================================
        // THEME MANAGEMENT
        // ============================================================================
        
        function initializeTheme() {
            document.body.setAttribute('data-theme', currentTheme);
            updateThemeButton();
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', currentTheme);
            localStorage.setItem('rei-pro-theme', currentTheme);
            updateThemeButton();
            showNotification(`Switched to ${currentTheme} theme`, 'success');
            console.log(`🎨 Theme changed to: ${currentTheme}`);
        }

        function updateThemeButton() {
            const themeButton = document.querySelector('[onclick="toggleTheme()"]');
            if (themeButton) {
                const icon = currentTheme === 'light' ? '🌙' : '☀️';
                const text = currentTheme === 'light' ? 'Dark' : 'Light';
                themeButton.innerHTML = `${icon} ${text}`;
            }
        }

        // ============================================================================
        // PROPERTY MANAGEMENT
        // ============================================================================
        
        function loadProperties() {
            console.log('🏠 Loading properties...');
            properties = [...sampleProperties];
            filteredProperties = [...properties];
            console.log(`✅ Loaded ${properties.length} properties`);
        }

        function renderProperties() {
            if (currentView === 'grid') {
                renderGridView();
            } else {
                renderTableView();
            }
        }

        function renderGridView() {
            const container = document.getElementById('gridView');
            container.innerHTML = '';

            filteredProperties.forEach((property, index) => {
                const card = document.createElement('div');
                card.className = 'property-card';
                card.style.animationDelay = `${index * 0.1}s`;
                card.onclick = () => viewProperty(property.id);

                card.innerHTML = `
                    <div class="property-image">
                        ${property.image}
                        <div class="property-status status-${property.status}">${property.status.charAt(0).toUpperCase() + property.status.slice(1)}</div>
                    </div>
                    <div class="property-content">
                        <div class="property-price">$${property.price.toLocaleString()}</div>
                        <div class="property-address">${property.address}</div>
                        <div class="property-location">${property.city}, ${property.state}</div>
                        <div class="property-details">
                            <div class="property-metric">🛏️ ${property.bedrooms} beds</div>
                            <div class="property-metric">🚿 ${property.bathrooms} baths</div>
                            <div class="property-metric">📐 ${property.sqft.toLocaleString()} sqft</div>
                        </div>
                        <div class="property-roi">ROI: ${property.roi}%</div>
                        <div class="property-actions">
                            <button class="btn btn-small" onclick="event.stopPropagation(); openCalculator(${property.id})">📊 Calculate</button>
                            <button class="btn btn-small primary" onclick="event.stopPropagation(); createOffer(${property.id})">💼 Offer</button>
                            <button class="btn btn-small" onclick="event.stopPropagation(); saveProperty(${property.id})">❤️ Save</button>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });

            console.log(`📋 Rendered ${filteredProperties.length} properties in grid view`);
        }

        function renderTableView() {
            const container = document.getElementById('tableView');
            const existingRows = container.querySelectorAll('.table-row');
            existingRows.forEach(row => row.remove());

            filteredProperties.forEach(property => {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.onclick = () => viewProperty(property.id);

                row.innerHTML = `
                    <div>
                        <strong>${property.address}</strong><br>
                        <small>${property.city}, ${property.state}</small>
                    </div>
                    <div>$${property.price.toLocaleString()}</div>
                    <div>${property.roi}%</div>
                    <div><span class="property-status status-${property.status}">${property.status}</span></div>
                    <div>${property.bedrooms}BR/${property.bathrooms}BA • ${property.sqft.toLocaleString()} sqft</div>
                    <div>
                        <button class="btn btn-small" onclick="event.stopPropagation(); openCalculator(${property.id})">📊</button>
                        <button class="btn btn-small primary" onclick="event.stopPropagation(); createOffer(${property.id})">💼</button>
                    </div>
                `;

                container.appendChild(row);
            });

            console.log(`📋 Rendered ${filteredProperties.length} properties in table view`);
        }

        // ============================================================================
        // SEARCH & FILTERING
        // ============================================================================
        
        function searchProperties() {
            console.log('🔍 Searching properties...');
            
            const location = document.getElementById('searchLocation').value.toLowerCase();
            const priceRange = document.getElementById('priceRange').value;
            const propertyType = document.getElementById('propertyType').value;
            const minROI = parseFloat(document.getElementById('minROI').value) || 0;
            const bedrooms = parseInt(document.getElementById('bedrooms').value) || 0;
            const status = document.getElementById('status').value;

            filteredProperties = properties.filter(property => {
                // Location filter
                if (location && !property.city.toLowerCase().includes(location) && 
                    !property.state.toLowerCase().includes(location)) {
                    return false;
                }

                // Price range filter
                if (priceRange) {
                    const [min, max] = priceRange.split('-').map(Number);
                    if (property.price < min || (max && property.price > max)) {
                        return false;
                    }
                }

                // Property type filter
                if (propertyType && property.type !== propertyType) {
                    return false;
                }

                // ROI filter
                if (property.roi < minROI) {
                    return false;
                }

                // Bedrooms filter
                if (bedrooms > 0 && property.bedrooms < bedrooms) {
                    return false;
                }

                // Status filter
                if (status && property.status !== status) {
                    return false;
                }

                return true;
            });

            renderProperties();
            showNotification(`Found ${filteredProperties.length} matching properties`, 'success');
            console.log(`✅ Search completed: ${filteredProperties.length} results`);
        }

        function clearSearch() {
            console.log('🧹 Clearing search...');
            
            // Reset form inputs
            document.getElementById('searchLocation').value = '';
            document.getElementById('priceRange').value = '';
            document.getElementById('propertyType').value = '';
            document.getElementById('minROI').value = '';
            document.getElementById('bedrooms').value = '';
            document.getElementById('status').value = '';

            // Reset filtered properties
            filteredProperties = [...properties];
            renderProperties();
            
            showNotification('Search cleared', 'success');
            console.log('✅ Search cleared');
        }

        function saveSearch() {
            console.log('💾 Save search clicked');
            showNotification('Search saved to your favorites!', 'success');
        }

        function showAdvancedSearch() {
            console.log('🔍 Advanced search clicked');
            showNotification('Advanced search options coming soon!', 'info');
        }

        // ============================================================================
        // VIEW MANAGEMENT
        // ============================================================================
        
        function setView(view) {
            console.log(`👁️ Switching to ${view} view`);
            
            currentView = view;
            
            // Update button states
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Show/hide views
            if (view === 'grid') {
                document.getElementById('gridView').style.display = 'grid';
                document.getElementById('tableView').style.display = 'none';
            } else {
                document.getElementById('gridView').style.display = 'none';
                document.getElementById('tableView').style.display = 'block';
            }
            
            renderProperties();
            showNotification(`Switched to ${view} view`, 'success');
        }

        // ============================================================================
        // PROPERTY ACTIONS
        // ============================================================================
        
        function viewProperty(propertyId) {
            console.log(`👁️ Viewing property ${propertyId}`);
            const property = properties.find(p => p.id === propertyId);
            
            if (property) {
                const details = `Property Details:

${property.address}
${property.city}, ${property.state}

Price: $${property.price.toLocaleString()}
Bedrooms: ${property.bedrooms}
Bathrooms: ${property.bathrooms}
Square Feet: ${property.sqft.toLocaleString()}
Year Built: ${property.yearBuilt}
Lot Size: ${property.lotSize} acres
Type: ${property.type.replace('-', ' ')}
Status: ${property.status}

Projected ROI: ${property.roi}%

${property.description}`;

                alert(details);
                console.log('✅ Property details displayed');
            }
        }

        function createOffer(propertyId) {
            console.log(`💼 Creating offer for property ${propertyId}`);
            showNotification('Redirecting to Auto Offers...', 'info');
            setTimeout(() => {
                window.location.href = `index.html?property=${propertyId}`;
            }, 1000);
        }

        function saveProperty(propertyId) {
            console.log(`❤️ Saving property ${propertyId}`);
            showNotification('Property saved to your favorites!', 'success');
        }

        function showImportModal() {
            console.log('📥 Import modal clicked');
            showNotification('Property import functionality coming soon!', 'info');
        }

        function showAddPropertyModal() {
            console.log('➕ Add property modal clicked');
            showNotification('Add property form coming soon!', 'info');
        }

        // ============================================================================
        // DEAL CALCULATOR
        // ============================================================================
        
        function openCalculator(propertyId) {
            console.log(`📊 Opening calculator for property ${propertyId}`);
            
            const property = properties.find(p => p.id === propertyId);
            if (property) {
                // Pre-fill with property data
                document.getElementById('purchasePrice').value = property.price;
                document.getElementById('downPayment').value = 20;
                document.getElementById('interestRate').value = 6.5;
                document.getElementById('loanTerm').value = 30;
                document.getElementById('monthlyRent').value = Math.round(property.price * 0.01);
                document.getElementById('propertyTaxes').value = Math.round(property.price * 0.012);
                document.getElementById('insurance').value = 1200;
                document.getElementById('maintenance').value = 10;
                
                calculateDeal();
                showModal('calculatorModal');
            }
        }

        function calculateDeal() {
            try {
                const purchasePrice = parseFloat(document.getElementById('purchasePrice').value) || 0;
                const downPaymentPercent = parseFloat(document.getElementById('downPayment').value) || 20;
                const interestRate = parseFloat(document.getElementById('interestRate').value) || 6.5;
                const loanTerm = parseFloat(document.getElementById('loanTerm').value) || 30;
                const monthlyRent = parseFloat(document.getElementById('monthlyRent').value) || 0;
                const propertyTaxes = parseFloat(document.getElementById('propertyTaxes').value) || 0;
                const insurance = parseFloat(document.getElementById('insurance').value) || 0;
                const maintenancePercent = parseFloat(document.getElementById('maintenance').value) || 10;

                if (purchasePrice === 0) return;

                // Calculate loan details
                const downPayment = purchasePrice * (downPaymentPercent / 100);
                const loanAmount = purchasePrice - downPayment;
                const monthlyRate = (interestRate / 100) / 12;
                const numberOfPayments = loanTerm * 12;
                
                // Monthly mortgage payment
                const monthlyMortgage = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / 
                                     (Math.pow(1 + monthlyRate, numberOfPayments) - 1);

                // Monthly expenses
                const monthlyTaxes = propertyTaxes / 12;
                const monthlyInsurance = insurance / 12;
                const monthlyMaintenance = monthlyRent * (maintenancePercent / 100);
                
                const totalMonthlyExpenses = monthlyMortgage + monthlyTaxes + monthlyInsurance + monthlyMaintenance;
                
                // Cash flow
                const monthlyCashFlow = monthlyRent - totalMonthlyExpenses;
                const annualCashFlow = monthlyCashFlow * 12;
                
                // ROI calculation
                const totalInvestment = downPayment;
                const annualROI = (annualCashFlow / totalInvestment) * 100;

                // Update display
                document.getElementById('monthlyROI').textContent = `$${monthlyCashFlow.toFixed(0)}`;
                document.getElementById('annualROI').textContent = `${annualROI.toFixed(1)}%`;

                console.log(`📊 Deal calculated: $${monthlyCashFlow.toFixed(0)}/month, ${annualROI.toFixed(1)}% ROI`);
            } catch (error) {
                console.error('❌ Calculation error:', error);
            }
        }

        function saveCalculation() {
            console.log('💾 Saving calculation...');
            showNotification('Deal analysis saved!', 'success');
            closeModal('calculatorModal');
        }

        // ============================================================================
        // MODAL MANAGEMENT
        // ============================================================================
        
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // ============================================================================
        // UTILITY FUNCTIONS
        // ============================================================================
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
            console.log('📱 Sidebar toggled');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <span>${type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}</span>
                <span>${message}</span>
            `;
            
            const colors = {
                success: '#10b981',
                error: '#ef4444',
                info: '#3b82f6'
            };
            
            notification.style.background = colors[type] || colors.info;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
            
            console.log(`🔔 ${type}: ${message}`);
        }

        // Initialize platform state
        window.REI_PRO_PLATFORM = window.REI_PRO_PLATFORM || {};
        window.REI_PRO_PLATFORM.currentModule = 'properties';

        console.log('🏘️ REI Pro Properties Module Loaded');
        console.log('✅ Platform integration ready');
        console.log('🚀 Ready for property search and analysis!');
    </script>
</body>
</html> 